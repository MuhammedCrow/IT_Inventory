SELECT consumable.name, sum(consConsumption.amount) as amount from consConsumption INNER JOIN consumable on consConsumption.consId = consumable.id WHERE consConsumption.date >= \'?\' AND consConsumption.date < \'?\' AND consConsumption.deptId = ? AND consConsumption.catId = ? GROUP BY consumable.name